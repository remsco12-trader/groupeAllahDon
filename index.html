<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Annuaire des contacts</title>
  <!-- Icônes FontAwesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #f0f8ff, #e6eaf8);
    }

    /* ==== HEADER ==== */
    header {
      background: #1e3a8a;
      padding: 15px;
      color: white;
      text-align: center;
      position: relative;
    }
    header img {
      max-width: 100px;
      border-radius: 50%;
    }
    header h1 {
      margin: 10px 0 0;
      font-size: 22px;
    }

    /* ==== BARRE DE FILTRES ==== */
    #filters {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 20px auto;
      flex-wrap: wrap;
    }
    #filters button {
      padding: 10px 18px;
      border: none;
      border-radius: 20px;
      background: #3b82f6;
      color: white;
      cursor: pointer;
      transition: 0.2s;
      font-size: 14px;
    }
    #filters button:hover {
      background: #2563eb;
    }

    /* ==== LISTE DES CONTACTS ==== */
    #contacts {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .contact-card {
      background: white;
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .contact-card:hover {
      transform: translateY(-5px);
    }

    .contact-card h3 {
      margin: 0 0 8px 0;
      color: #1e40af;
    }

    .contact-card p {
      margin: 6px 0;
      font-size: 14px;
      color: #374151;
    }

    .contact-card i {
      color: #1e3a8a;
      margin-right: 8px;
    }
  </style>
</head>
<body>
  <!-- ==== ENTÊTE ==== -->
  <header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Example.jpg/200px-Example.jpg" alt="Logo" />
    <h1>Annuaire des Contacts</h1>
  </header>

  <!-- ==== FILTRES ==== -->
  <div id="filters">
    <button onclick="filterContacts('Tous')">Tous</button>
    <button onclick="filterContacts('Travailleur')">Travailleurs</button>
    <button onclick="filterContacts('Non travailleur')">Non travailleurs</button>
  </div>

  <!-- ==== LISTE DE CONTACTS ==== -->
  <div id="contacts">
    <!-- Exemple fictif pour test -->
    <div class="contact-card" data-statut="Travailleur">
      <h3>Jean Dupont</h3>
      <p><i class="fa fa-phone"></i><a href="tel:+33123456789">+33 1 23 45 67 89</a></p>
      <p><i class="fa fa-briefcase"></i> Enseignant</p>
      <p><i class="fa fa-map-marker-alt"></i> Bamako-Coura</p>
      <p><i class="fa fa-graduation-cap"></i> Licence</p>
      <p><i class="fa fa-flag"></i> Mali</p>
      <p><strong>Statut :</strong> Travailleur</p>
    </div>
    <div class="contact-card" data-statut="Non travailleur">
      <h3>Fatoumata Koné</h3>
      <p><i class="fa fa-phone"></i><a href="tel:+22398765432">+223 98 76 54 32</a></p>
      <p><i class="fa fa-briefcase"></i> Étudiante</p>
      <p><i class="fa fa-map-marker-alt"></i> ACI 2000</p>
      <p><i class="fa fa-graduation-cap"></i> Master</p>
      <p><i class="fa fa-flag"></i> Mali</p>
      <p><strong>Statut :</strong> Non travailleur</p>
    </div>
  </div>

  <script>
    // === FILTRAGE ===
    function filterContacts(statut) {
      const cards = document.querySelectorAll('.contact-card');
      cards.forEach(card => {
        if (statut === 'Tous' || card.getAttribute('data-statut') === statut) {
          card.style.display = "block";
        } else {
          card.style.display = "none";
        }
      });
    }

    // === REMPLACER DONNÉES PAR GOOGLE SHEET ===
    const sheetUrl = "https://docs.google.com/spreadsheets/d/1lQVgkO9AQ3l73MncVuSmIe4UO2LGAmWBXIAARTonQKY/gviz/tq?tqx=out:csv&sheet=liste";

    async function fetchData() {
      try {
        const res = await fetch(sheetUrl);
        const text = await res.text();

        const rows = text.split("\n").map(r => r.split(","));
        const headers = rows[0];
        const data = rows.slice(1);

        const contactsDiv = document.getElementById("contacts");
        contactsDiv.innerHTML = "";

        data.forEach(row => {
          if (row.length < 7) return;

          const contact = {};
          headers.forEach((h, i) => contact[h.trim()] = row[i]?.trim());

          const card = document.createElement("div");
          card.className = "contact-card";
          card.setAttribute("data-statut", contact["Statut"] || "Inconnu");

          card.innerHTML = `
            <h3>${contact["Nom"] || ""} ${contact["Prénom"] || ""}</h3>
            <p><i class="fa fa-phone"></i><a href="tel:${contact["Téléphone"] || ""}">${contact["Téléphone"] || ""}</a></p>
            <p><i class="fa fa-briefcase"></i> ${contact["Profession"] || ""}</p>
            <p><i class="fa fa-map-marker-alt"></i> ${contact["Quartier"] || ""}</p>
            <p><i class="fa fa-graduation-cap"></i> ${contact["Formation"] || ""}</p>
            <p><i class="fa fa-flag"></i> ${contact["Pays"] || ""}</p>
            <p><strong>Statut :</strong> ${contact["Statut"] || ""}</p>
          `;
          contactsDiv.appendChild(card);
        });
      } catch (e) {
        console.error("Erreur Google Sheet :", e);
      }
    }

    fetchData();
  </script>
</body>
</html>
